/// @spec_ref: 7.4
/// @point_id: 7_4_item
/// @case_id: 7_4_item__core_pass
/// @expect: pass
/// @boundary: core
/// @phase: sema
/// @diag_codes:
/// @diag_keywords:
// 泛型结构体 — 实例化、字段访问、泛型 impl 方法

struct Pair<T> {
    first: T,
    second: T,
}

impl<T> Pair<T> {
    func new(a: T, b: T) -> Pair<T> {
        return Pair { first: a, second: b }
    }

    func get_first(&self) -> T {
        return self.first
    }

    func get_second(&self) -> T {
        return self.second
    }
}

struct Box<T> {
    value: T,
}

func main() -> i32 {
    // 泛型结构体：直接字段初始化和访问
    var p = Pair { first: 3, second: 7 }
    @assert(p.first == 3, "7.4 generic struct: first field")
    @assert(p.second == 7, "7.4 generic struct: second field")
    @assert(p.first + p.second == 10, "7.4 generic struct: sum")

    // impl 方法调用
    var p2 = Pair<i32>.new(10, 20)
    @assert(p2.get_first() == 10, "7.4 generic struct: get_first")
    @assert(p2.get_second() == 20, "7.4 generic struct: get_second")

    // Box<T> 直接字段访问
    var b = Box { value: 42 }
    @assert(b.value == 42, "7.4 generic struct: Box value")

    return 0
}
