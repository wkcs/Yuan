/// @spec_ref: 9.4
/// @point_id: 9_4_trait
/// @case_id: 9_4_trait__core_pass
/// @expect: pass
/// @boundary: core
/// @phase: sema
/// @diag_codes:
/// @diag_keywords:
// 常用内置 Trait + 所有权语义（Copy / Drop / self 接收）

struct Vec2 {
    x: i32,
    y: i32,
}

struct ConsumeMe {
    value: i32,
}

impl ConsumeMe {
    func into_value(self) -> i32 {
        return self.value
    }
}

impl Drop for ConsumeMe {
    func drop(&mut self) -> void {
        self.value = 0
    }
}

func main() -> i32 {
    // Copy: 结构化 Copy 类型赋值后源值仍可用
    var v = Vec2 { x: 3, y: 4 }
    var c = v
    c.x = 99
    @assert(v.x == 3, "9.4 Copy: original unchanged after copy-assignment")
    @assert(c.x == 99, "9.4 Copy: copied value is mutable independently")

    // self: Self 按值消费接收者
    var token = ConsumeMe { value: 7 }
    var out = token.into_value()
    @assert(out == 7, "9.4 self:Self consumes receiver")

    return 0
}
